{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nimport { getWindow, h, scheduleAtNextAnimationFrame } from '../../../../base/browser/dom.js';\nimport { SmoothScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { findFirstMaxBy } from '../../../../base/common/arraysFind.js';\nimport { Disposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, autorunWithStore, derived, derivedObservableWithCache, derivedWithStore, observableFromEvent, observableValue } from '../../../../base/common/observable.js';\nimport { disposableObservableValue, globalTransaction, transaction } from '../../../../base/common/observableInternal/base.js';\nimport { Scrollable } from '../../../../base/common/scrollable.js';\nimport './style.css';\nimport { ObservableElementSizeObserver } from '../diffEditor/utils.js';\nimport { OffsetRange } from '../../../common/core/offsetRange.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { DiffEditorItemTemplate, TemplateData } from './diffEditorItemTemplate.js';\nimport { ObjectPool } from './objectPool.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ServiceCollection } from '../../../../platform/instantiation/common/serviceCollection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { Selection } from '../../../common/core/selection.js';\nlet MultiDiffEditorWidgetImpl = class MultiDiffEditorWidgetImpl extends Disposable {\n  constructor(_element, _dimension, _viewModel, _workbenchUIElementFactory, _parentContextKeyService, _parentInstantiationService) {\n    super();\n    this._element = _element;\n    this._dimension = _dimension;\n    this._viewModel = _viewModel;\n    this._workbenchUIElementFactory = _workbenchUIElementFactory;\n    this._parentContextKeyService = _parentContextKeyService;\n    this._parentInstantiationService = _parentInstantiationService;\n    this._elements = h('div.monaco-component.multiDiffEditor', [h('div@content', {\n      style: {\n        overflow: 'hidden'\n      }\n    }), h('div.monaco-editor@overflowWidgetsDomNode', {})]);\n    this._sizeObserver = this._register(new ObservableElementSizeObserver(this._element, undefined));\n    this._objectPool = this._register(new ObjectPool(data => {\n      const template = this._instantiationService.createInstance(DiffEditorItemTemplate, this._elements.content, this._elements.overflowWidgetsDomNode, this._workbenchUIElementFactory);\n      template.setData(data);\n      return template;\n    }));\n    this._scrollable = this._register(new Scrollable({\n      forceIntegerValues: false,\n      scheduleAtNextAnimationFrame: cb => scheduleAtNextAnimationFrame(getWindow(this._element), cb),\n      smoothScrollDuration: 100\n    }));\n    this._scrollableElement = this._register(new SmoothScrollableElement(this._elements.root, {\n      vertical: 1 /* ScrollbarVisibility.Auto */,\n      horizontal: 1 /* ScrollbarVisibility.Auto */,\n      useShadows: false\n    }, this._scrollable));\n    this.scrollTop = observableFromEvent(this._scrollableElement.onScroll, () => /** @description scrollTop */this._scrollableElement.getScrollPosition().scrollTop);\n    this.scrollLeft = observableFromEvent(this._scrollableElement.onScroll, () => /** @description scrollLeft */this._scrollableElement.getScrollPosition().scrollLeft);\n    this._viewItems = derivedWithStore(this, (reader, store) => {\n      const vm = this._viewModel.read(reader);\n      if (!vm) {\n        return [];\n      }\n      const items = vm.items.read(reader);\n      return items.map(d => {\n        var _a;\n        const item = store.add(new VirtualizedViewItem(d, this._objectPool, this.scrollLeft));\n        const data = (_a = this._lastDocStates) === null || _a === void 0 ? void 0 : _a[item.getKey()];\n        if (data) {\n          transaction(tx => {\n            item.setViewState(data, tx);\n          });\n        }\n        return item;\n      });\n    });\n    this._spaceBetweenPx = 10;\n    this._totalHeight = this._viewItems.map(this, (items, reader) => items.reduce((r, i) => r + i.contentHeight.read(reader) + this._spaceBetweenPx, 0));\n    this.activeDiffItem = derived(this, reader => this._viewItems.read(reader).find(i => {\n      var _a;\n      return (_a = i.template.read(reader)) === null || _a === void 0 ? void 0 : _a.isFocused.read(reader);\n    }));\n    this.lastActiveDiffItem = derivedObservableWithCache((reader, lastValue) => {\n      var _a;\n      return (_a = this.activeDiffItem.read(reader)) !== null && _a !== void 0 ? _a : lastValue;\n    });\n    this._contextKeyService = this._register(this._parentContextKeyService.createScoped(this._element));\n    this._instantiationService = this._parentInstantiationService.createChild(new ServiceCollection([IContextKeyService, this._contextKeyService]));\n    /** This accounts for documents that are not loaded yet. */\n    this._lastDocStates = {};\n    this._contextKeyService.createKey(EditorContextKeys.inMultiDiffEditor.key, true);\n    this._register(autorunWithStore((reader, store) => {\n      const viewModel = this._viewModel.read(reader);\n      if (viewModel && viewModel.contextKeys) {\n        for (const [key, value] of Object.entries(viewModel.contextKeys)) {\n          const contextKey = this._contextKeyService.createKey(key, undefined);\n          contextKey.set(value);\n          store.add(toDisposable(() => contextKey.reset()));\n        }\n      }\n    }));\n    const ctxAllCollapsed = this._parentContextKeyService.createKey(EditorContextKeys.multiDiffEditorAllCollapsed.key, false);\n    this._register(autorun(reader => {\n      const viewModel = this._viewModel.read(reader);\n      if (viewModel) {\n        const allCollapsed = viewModel.items.read(reader).every(item => item.collapsed.read(reader));\n        ctxAllCollapsed.set(allCollapsed);\n      }\n    }));\n    this._register(autorun(reader => {\n      const lastActiveDiffItem = this.lastActiveDiffItem.read(reader);\n      transaction(tx => {\n        var _a;\n        (_a = this._viewModel.read(reader)) === null || _a === void 0 ? void 0 : _a.activeDiffItem.set(lastActiveDiffItem === null || lastActiveDiffItem === void 0 ? void 0 : lastActiveDiffItem.viewModel, tx);\n      });\n    }));\n    this._register(autorun(reader => {\n      /** @description Update widget dimension */\n      const dimension = this._dimension.read(reader);\n      this._sizeObserver.observe(dimension);\n    }));\n    this._elements.content.style.position = 'relative';\n    this._register(autorun(reader => {\n      /** @description Update scroll dimensions */\n      const height = this._sizeObserver.height.read(reader);\n      this._elements.root.style.height = `${height}px`;\n      const totalHeight = this._totalHeight.read(reader);\n      this._elements.content.style.height = `${totalHeight}px`;\n      const width = this._sizeObserver.width.read(reader);\n      let scrollWidth = width;\n      const viewItems = this._viewItems.read(reader);\n      const max = findFirstMaxBy(viewItems, i => i.maxScroll.read(reader).maxScroll);\n      if (max) {\n        const maxScroll = max.maxScroll.read(reader);\n        scrollWidth = width + maxScroll.maxScroll;\n      }\n      this._scrollableElement.setScrollDimensions({\n        width: width,\n        height: height,\n        scrollHeight: totalHeight,\n        scrollWidth\n      });\n    }));\n    _element.replaceChildren(this._scrollableElement.getDomNode());\n    this._register(toDisposable(() => {\n      _element.replaceChildren();\n    }));\n    this._register(this._register(autorun(reader => {\n      /** @description Render all */\n      globalTransaction(tx => {\n        this.render(reader);\n      });\n    })));\n  }\n  render(reader) {\n    const scrollTop = this.scrollTop.read(reader);\n    let contentScrollOffsetToScrollOffset = 0;\n    let itemHeightSumBefore = 0;\n    let itemContentHeightSumBefore = 0;\n    const viewPortHeight = this._sizeObserver.height.read(reader);\n    const contentViewPort = OffsetRange.ofStartAndLength(scrollTop, viewPortHeight);\n    const width = this._sizeObserver.width.read(reader);\n    for (const v of this._viewItems.read(reader)) {\n      const itemContentHeight = v.contentHeight.read(reader);\n      const itemHeight = Math.min(itemContentHeight, viewPortHeight);\n      const itemRange = OffsetRange.ofStartAndLength(itemHeightSumBefore, itemHeight);\n      const itemContentRange = OffsetRange.ofStartAndLength(itemContentHeightSumBefore, itemContentHeight);\n      if (itemContentRange.isBefore(contentViewPort)) {\n        contentScrollOffsetToScrollOffset -= itemContentHeight - itemHeight;\n        v.hide();\n      } else if (itemContentRange.isAfter(contentViewPort)) {\n        v.hide();\n      } else {\n        const scroll = Math.max(0, Math.min(contentViewPort.start - itemContentRange.start, itemContentHeight - itemHeight));\n        contentScrollOffsetToScrollOffset -= scroll;\n        const viewPort = OffsetRange.ofStartAndLength(scrollTop + contentScrollOffsetToScrollOffset, viewPortHeight);\n        v.render(itemRange, scroll, width, viewPort);\n      }\n      itemHeightSumBefore += itemHeight + this._spaceBetweenPx;\n      itemContentHeightSumBefore += itemContentHeight + this._spaceBetweenPx;\n    }\n    this._elements.content.style.transform = `translateY(${-(scrollTop + contentScrollOffsetToScrollOffset)}px)`;\n  }\n};\nMultiDiffEditorWidgetImpl = __decorate([__param(4, IContextKeyService), __param(5, IInstantiationService)], MultiDiffEditorWidgetImpl);\nexport { MultiDiffEditorWidgetImpl };\nclass VirtualizedViewItem extends Disposable {\n  constructor(viewModel, _objectPool, _scrollLeft) {\n    super();\n    this.viewModel = viewModel;\n    this._objectPool = _objectPool;\n    this._scrollLeft = _scrollLeft;\n    this._templateRef = this._register(disposableObservableValue(this, undefined));\n    this.contentHeight = derived(this, reader => {\n      var _a, _b, _c;\n      return (_c = (_b = (_a = this._templateRef.read(reader)) === null || _a === void 0 ? void 0 : _a.object.contentHeight) === null || _b === void 0 ? void 0 : _b.read(reader)) !== null && _c !== void 0 ? _c : this.viewModel.lastTemplateData.read(reader).contentHeight;\n    });\n    this.maxScroll = derived(this, reader => {\n      var _a, _b;\n      return (_b = (_a = this._templateRef.read(reader)) === null || _a === void 0 ? void 0 : _a.object.maxScroll.read(reader)) !== null && _b !== void 0 ? _b : {\n        maxScroll: 0,\n        scrollWidth: 0\n      };\n    });\n    this.template = derived(this, reader => {\n      var _a;\n      return (_a = this._templateRef.read(reader)) === null || _a === void 0 ? void 0 : _a.object;\n    });\n    this._isHidden = observableValue(this, false);\n    this._register(autorun(reader => {\n      var _a;\n      const scrollLeft = this._scrollLeft.read(reader);\n      (_a = this._templateRef.read(reader)) === null || _a === void 0 ? void 0 : _a.object.setScrollLeft(scrollLeft);\n    }));\n    this._register(autorun(reader => {\n      const ref = this._templateRef.read(reader);\n      if (!ref) {\n        return;\n      }\n      const isHidden = this._isHidden.read(reader);\n      if (!isHidden) {\n        return;\n      }\n      const isFocused = ref.object.isFocused.read(reader);\n      if (isFocused) {\n        return;\n      }\n      this._clear();\n    }));\n  }\n  dispose() {\n    this._clear();\n    super.dispose();\n  }\n  toString() {\n    var _a;\n    return `VirtualViewItem(${(_a = this.viewModel.entry.value.modified) === null || _a === void 0 ? void 0 : _a.uri.toString()})`;\n  }\n  getKey() {\n    return this.viewModel.getKey();\n  }\n  setViewState(viewState, tx) {\n    var _a;\n    this.viewModel.collapsed.set(viewState.collapsed, tx);\n    this._updateTemplateData(tx);\n    const data = this.viewModel.lastTemplateData.get();\n    const selections = (_a = viewState.selections) === null || _a === void 0 ? void 0 : _a.map(Selection.liftSelection);\n    this.viewModel.lastTemplateData.set({\n      ...data,\n      selections\n    }, tx);\n    const ref = this._templateRef.get();\n    if (ref) {\n      if (selections) {\n        ref.object.editor.setSelections(selections);\n      }\n    }\n  }\n  _updateTemplateData(tx) {\n    var _a;\n    const ref = this._templateRef.get();\n    if (!ref) {\n      return;\n    }\n    this.viewModel.lastTemplateData.set({\n      contentHeight: ref.object.contentHeight.get(),\n      selections: (_a = ref.object.editor.getSelections()) !== null && _a !== void 0 ? _a : undefined\n    }, tx);\n  }\n  _clear() {\n    const ref = this._templateRef.get();\n    if (!ref) {\n      return;\n    }\n    transaction(tx => {\n      this._updateTemplateData(tx);\n      ref.object.hide();\n      this._templateRef.set(undefined, tx);\n    });\n  }\n  hide() {\n    this._isHidden.set(true, undefined);\n  }\n  render(verticalSpace, offset, width, viewPort) {\n    this._isHidden.set(false, undefined);\n    let ref = this._templateRef.get();\n    if (!ref) {\n      ref = this._objectPool.getUnusedObj(new TemplateData(this.viewModel));\n      this._templateRef.set(ref, undefined);\n      const selections = this.viewModel.lastTemplateData.get().selections;\n      if (selections) {\n        ref.object.editor.setSelections(selections);\n      }\n    }\n    ref.object.render(verticalSpace, width, offset, viewPort);\n  }\n}","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","getWindow","h","scheduleAtNextAnimationFrame","SmoothScrollableElement","findFirstMaxBy","Disposable","toDisposable","autorun","autorunWithStore","derived","derivedObservableWithCache","derivedWithStore","observableFromEvent","observableValue","disposableObservableValue","globalTransaction","transaction","Scrollable","ObservableElementSizeObserver","OffsetRange","IInstantiationService","DiffEditorItemTemplate","TemplateData","ObjectPool","IContextKeyService","ServiceCollection","EditorContextKeys","Selection","MultiDiffEditorWidgetImpl","constructor","_element","_dimension","_viewModel","_workbenchUIElementFactory","_parentContextKeyService","_parentInstantiationService","_elements","style","overflow","_sizeObserver","_register","undefined","_objectPool","data","template","_instantiationService","createInstance","content","overflowWidgetsDomNode","setData","_scrollable","forceIntegerValues","cb","smoothScrollDuration","_scrollableElement","root","vertical","horizontal","useShadows","scrollTop","onScroll","getScrollPosition","scrollLeft","_viewItems","reader","store","vm","read","items","map","_a","item","add","VirtualizedViewItem","_lastDocStates","getKey","tx","setViewState","_spaceBetweenPx","_totalHeight","reduce","contentHeight","activeDiffItem","find","isFocused","lastActiveDiffItem","lastValue","_contextKeyService","createScoped","createChild","createKey","inMultiDiffEditor","viewModel","contextKeys","value","entries","contextKey","set","reset","ctxAllCollapsed","multiDiffEditorAllCollapsed","allCollapsed","every","collapsed","dimension","observe","position","height","totalHeight","width","scrollWidth","viewItems","max","maxScroll","setScrollDimensions","scrollHeight","replaceChildren","getDomNode","render","contentScrollOffsetToScrollOffset","itemHeightSumBefore","itemContentHeightSumBefore","viewPortHeight","contentViewPort","ofStartAndLength","v","itemContentHeight","itemHeight","Math","min","itemRange","itemContentRange","isBefore","hide","isAfter","scroll","start","viewPort","transform","_scrollLeft","_templateRef","_b","_c","object","lastTemplateData","_isHidden","setScrollLeft","ref","isHidden","_clear","dispose","toString","entry","modified","uri","viewState","_updateTemplateData","get","selections","liftSelection","editor","setSelections","getSelections","verticalSpace","offset","getUnusedObj"],"sources":["D:/yupi/OJ System/OJ System/feioj-front/node_modules/monaco-editor/esm/vs/editor/browser/widget/multiDiffEditorWidget/multiDiffEditorWidgetImpl.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { getWindow, h, scheduleAtNextAnimationFrame } from '../../../../base/browser/dom.js';\nimport { SmoothScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { findFirstMaxBy } from '../../../../base/common/arraysFind.js';\nimport { Disposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, autorunWithStore, derived, derivedObservableWithCache, derivedWithStore, observableFromEvent, observableValue } from '../../../../base/common/observable.js';\nimport { disposableObservableValue, globalTransaction, transaction } from '../../../../base/common/observableInternal/base.js';\nimport { Scrollable } from '../../../../base/common/scrollable.js';\nimport './style.css';\nimport { ObservableElementSizeObserver } from '../diffEditor/utils.js';\nimport { OffsetRange } from '../../../common/core/offsetRange.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { DiffEditorItemTemplate, TemplateData } from './diffEditorItemTemplate.js';\nimport { ObjectPool } from './objectPool.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ServiceCollection } from '../../../../platform/instantiation/common/serviceCollection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { Selection } from '../../../common/core/selection.js';\nlet MultiDiffEditorWidgetImpl = class MultiDiffEditorWidgetImpl extends Disposable {\n    constructor(_element, _dimension, _viewModel, _workbenchUIElementFactory, _parentContextKeyService, _parentInstantiationService) {\n        super();\n        this._element = _element;\n        this._dimension = _dimension;\n        this._viewModel = _viewModel;\n        this._workbenchUIElementFactory = _workbenchUIElementFactory;\n        this._parentContextKeyService = _parentContextKeyService;\n        this._parentInstantiationService = _parentInstantiationService;\n        this._elements = h('div.monaco-component.multiDiffEditor', [\n            h('div@content', {\n                style: {\n                    overflow: 'hidden',\n                }\n            }),\n            h('div.monaco-editor@overflowWidgetsDomNode', {}),\n        ]);\n        this._sizeObserver = this._register(new ObservableElementSizeObserver(this._element, undefined));\n        this._objectPool = this._register(new ObjectPool((data) => {\n            const template = this._instantiationService.createInstance(DiffEditorItemTemplate, this._elements.content, this._elements.overflowWidgetsDomNode, this._workbenchUIElementFactory);\n            template.setData(data);\n            return template;\n        }));\n        this._scrollable = this._register(new Scrollable({\n            forceIntegerValues: false,\n            scheduleAtNextAnimationFrame: (cb) => scheduleAtNextAnimationFrame(getWindow(this._element), cb),\n            smoothScrollDuration: 100,\n        }));\n        this._scrollableElement = this._register(new SmoothScrollableElement(this._elements.root, {\n            vertical: 1 /* ScrollbarVisibility.Auto */,\n            horizontal: 1 /* ScrollbarVisibility.Auto */,\n            useShadows: false,\n        }, this._scrollable));\n        this.scrollTop = observableFromEvent(this._scrollableElement.onScroll, () => /** @description scrollTop */ this._scrollableElement.getScrollPosition().scrollTop);\n        this.scrollLeft = observableFromEvent(this._scrollableElement.onScroll, () => /** @description scrollLeft */ this._scrollableElement.getScrollPosition().scrollLeft);\n        this._viewItems = derivedWithStore(this, (reader, store) => {\n            const vm = this._viewModel.read(reader);\n            if (!vm) {\n                return [];\n            }\n            const items = vm.items.read(reader);\n            return items.map(d => {\n                var _a;\n                const item = store.add(new VirtualizedViewItem(d, this._objectPool, this.scrollLeft));\n                const data = (_a = this._lastDocStates) === null || _a === void 0 ? void 0 : _a[item.getKey()];\n                if (data) {\n                    transaction(tx => {\n                        item.setViewState(data, tx);\n                    });\n                }\n                return item;\n            });\n        });\n        this._spaceBetweenPx = 10;\n        this._totalHeight = this._viewItems.map(this, (items, reader) => items.reduce((r, i) => r + i.contentHeight.read(reader) + this._spaceBetweenPx, 0));\n        this.activeDiffItem = derived(this, reader => this._viewItems.read(reader).find(i => { var _a; return (_a = i.template.read(reader)) === null || _a === void 0 ? void 0 : _a.isFocused.read(reader); }));\n        this.lastActiveDiffItem = derivedObservableWithCache((reader, lastValue) => { var _a; return (_a = this.activeDiffItem.read(reader)) !== null && _a !== void 0 ? _a : lastValue; });\n        this._contextKeyService = this._register(this._parentContextKeyService.createScoped(this._element));\n        this._instantiationService = this._parentInstantiationService.createChild(new ServiceCollection([IContextKeyService, this._contextKeyService]));\n        /** This accounts for documents that are not loaded yet. */\n        this._lastDocStates = {};\n        this._contextKeyService.createKey(EditorContextKeys.inMultiDiffEditor.key, true);\n        this._register(autorunWithStore((reader, store) => {\n            const viewModel = this._viewModel.read(reader);\n            if (viewModel && viewModel.contextKeys) {\n                for (const [key, value] of Object.entries(viewModel.contextKeys)) {\n                    const contextKey = this._contextKeyService.createKey(key, undefined);\n                    contextKey.set(value);\n                    store.add(toDisposable(() => contextKey.reset()));\n                }\n            }\n        }));\n        const ctxAllCollapsed = this._parentContextKeyService.createKey(EditorContextKeys.multiDiffEditorAllCollapsed.key, false);\n        this._register(autorun((reader) => {\n            const viewModel = this._viewModel.read(reader);\n            if (viewModel) {\n                const allCollapsed = viewModel.items.read(reader).every(item => item.collapsed.read(reader));\n                ctxAllCollapsed.set(allCollapsed);\n            }\n        }));\n        this._register(autorun((reader) => {\n            const lastActiveDiffItem = this.lastActiveDiffItem.read(reader);\n            transaction(tx => {\n                var _a;\n                (_a = this._viewModel.read(reader)) === null || _a === void 0 ? void 0 : _a.activeDiffItem.set(lastActiveDiffItem === null || lastActiveDiffItem === void 0 ? void 0 : lastActiveDiffItem.viewModel, tx);\n            });\n        }));\n        this._register(autorun((reader) => {\n            /** @description Update widget dimension */\n            const dimension = this._dimension.read(reader);\n            this._sizeObserver.observe(dimension);\n        }));\n        this._elements.content.style.position = 'relative';\n        this._register(autorun((reader) => {\n            /** @description Update scroll dimensions */\n            const height = this._sizeObserver.height.read(reader);\n            this._elements.root.style.height = `${height}px`;\n            const totalHeight = this._totalHeight.read(reader);\n            this._elements.content.style.height = `${totalHeight}px`;\n            const width = this._sizeObserver.width.read(reader);\n            let scrollWidth = width;\n            const viewItems = this._viewItems.read(reader);\n            const max = findFirstMaxBy(viewItems, i => i.maxScroll.read(reader).maxScroll);\n            if (max) {\n                const maxScroll = max.maxScroll.read(reader);\n                scrollWidth = width + maxScroll.maxScroll;\n            }\n            this._scrollableElement.setScrollDimensions({\n                width: width,\n                height: height,\n                scrollHeight: totalHeight,\n                scrollWidth,\n            });\n        }));\n        _element.replaceChildren(this._scrollableElement.getDomNode());\n        this._register(toDisposable(() => {\n            _element.replaceChildren();\n        }));\n        this._register(this._register(autorun(reader => {\n            /** @description Render all */\n            globalTransaction(tx => {\n                this.render(reader);\n            });\n        })));\n    }\n    render(reader) {\n        const scrollTop = this.scrollTop.read(reader);\n        let contentScrollOffsetToScrollOffset = 0;\n        let itemHeightSumBefore = 0;\n        let itemContentHeightSumBefore = 0;\n        const viewPortHeight = this._sizeObserver.height.read(reader);\n        const contentViewPort = OffsetRange.ofStartAndLength(scrollTop, viewPortHeight);\n        const width = this._sizeObserver.width.read(reader);\n        for (const v of this._viewItems.read(reader)) {\n            const itemContentHeight = v.contentHeight.read(reader);\n            const itemHeight = Math.min(itemContentHeight, viewPortHeight);\n            const itemRange = OffsetRange.ofStartAndLength(itemHeightSumBefore, itemHeight);\n            const itemContentRange = OffsetRange.ofStartAndLength(itemContentHeightSumBefore, itemContentHeight);\n            if (itemContentRange.isBefore(contentViewPort)) {\n                contentScrollOffsetToScrollOffset -= itemContentHeight - itemHeight;\n                v.hide();\n            }\n            else if (itemContentRange.isAfter(contentViewPort)) {\n                v.hide();\n            }\n            else {\n                const scroll = Math.max(0, Math.min(contentViewPort.start - itemContentRange.start, itemContentHeight - itemHeight));\n                contentScrollOffsetToScrollOffset -= scroll;\n                const viewPort = OffsetRange.ofStartAndLength(scrollTop + contentScrollOffsetToScrollOffset, viewPortHeight);\n                v.render(itemRange, scroll, width, viewPort);\n            }\n            itemHeightSumBefore += itemHeight + this._spaceBetweenPx;\n            itemContentHeightSumBefore += itemContentHeight + this._spaceBetweenPx;\n        }\n        this._elements.content.style.transform = `translateY(${-(scrollTop + contentScrollOffsetToScrollOffset)}px)`;\n    }\n};\nMultiDiffEditorWidgetImpl = __decorate([\n    __param(4, IContextKeyService),\n    __param(5, IInstantiationService)\n], MultiDiffEditorWidgetImpl);\nexport { MultiDiffEditorWidgetImpl };\nclass VirtualizedViewItem extends Disposable {\n    constructor(viewModel, _objectPool, _scrollLeft) {\n        super();\n        this.viewModel = viewModel;\n        this._objectPool = _objectPool;\n        this._scrollLeft = _scrollLeft;\n        this._templateRef = this._register(disposableObservableValue(this, undefined));\n        this.contentHeight = derived(this, reader => { var _a, _b, _c; return (_c = (_b = (_a = this._templateRef.read(reader)) === null || _a === void 0 ? void 0 : _a.object.contentHeight) === null || _b === void 0 ? void 0 : _b.read(reader)) !== null && _c !== void 0 ? _c : this.viewModel.lastTemplateData.read(reader).contentHeight; });\n        this.maxScroll = derived(this, reader => { var _a, _b; return (_b = (_a = this._templateRef.read(reader)) === null || _a === void 0 ? void 0 : _a.object.maxScroll.read(reader)) !== null && _b !== void 0 ? _b : { maxScroll: 0, scrollWidth: 0 }; });\n        this.template = derived(this, reader => { var _a; return (_a = this._templateRef.read(reader)) === null || _a === void 0 ? void 0 : _a.object; });\n        this._isHidden = observableValue(this, false);\n        this._register(autorun((reader) => {\n            var _a;\n            const scrollLeft = this._scrollLeft.read(reader);\n            (_a = this._templateRef.read(reader)) === null || _a === void 0 ? void 0 : _a.object.setScrollLeft(scrollLeft);\n        }));\n        this._register(autorun(reader => {\n            const ref = this._templateRef.read(reader);\n            if (!ref) {\n                return;\n            }\n            const isHidden = this._isHidden.read(reader);\n            if (!isHidden) {\n                return;\n            }\n            const isFocused = ref.object.isFocused.read(reader);\n            if (isFocused) {\n                return;\n            }\n            this._clear();\n        }));\n    }\n    dispose() {\n        this._clear();\n        super.dispose();\n    }\n    toString() {\n        var _a;\n        return `VirtualViewItem(${(_a = this.viewModel.entry.value.modified) === null || _a === void 0 ? void 0 : _a.uri.toString()})`;\n    }\n    getKey() {\n        return this.viewModel.getKey();\n    }\n    setViewState(viewState, tx) {\n        var _a;\n        this.viewModel.collapsed.set(viewState.collapsed, tx);\n        this._updateTemplateData(tx);\n        const data = this.viewModel.lastTemplateData.get();\n        const selections = (_a = viewState.selections) === null || _a === void 0 ? void 0 : _a.map(Selection.liftSelection);\n        this.viewModel.lastTemplateData.set({\n            ...data,\n            selections,\n        }, tx);\n        const ref = this._templateRef.get();\n        if (ref) {\n            if (selections) {\n                ref.object.editor.setSelections(selections);\n            }\n        }\n    }\n    _updateTemplateData(tx) {\n        var _a;\n        const ref = this._templateRef.get();\n        if (!ref) {\n            return;\n        }\n        this.viewModel.lastTemplateData.set({\n            contentHeight: ref.object.contentHeight.get(),\n            selections: (_a = ref.object.editor.getSelections()) !== null && _a !== void 0 ? _a : undefined,\n        }, tx);\n    }\n    _clear() {\n        const ref = this._templateRef.get();\n        if (!ref) {\n            return;\n        }\n        transaction(tx => {\n            this._updateTemplateData(tx);\n            ref.object.hide();\n            this._templateRef.set(undefined, tx);\n        });\n    }\n    hide() {\n        this._isHidden.set(true, undefined);\n    }\n    render(verticalSpace, offset, width, viewPort) {\n        this._isHidden.set(false, undefined);\n        let ref = this._templateRef.get();\n        if (!ref) {\n            ref = this._objectPool.getUnusedObj(new TemplateData(this.viewModel));\n            this._templateRef.set(ref, undefined);\n            const selections = this.viewModel.lastTemplateData.get().selections;\n            if (selections) {\n                ref.object.editor.setSelections(selections);\n            }\n        }\n        ref.object.render(verticalSpace, width, offset, viewPort);\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}