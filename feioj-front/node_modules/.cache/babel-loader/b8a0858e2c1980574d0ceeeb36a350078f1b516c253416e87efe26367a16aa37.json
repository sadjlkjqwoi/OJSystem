{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nimport * as dom from '../../base/browser/dom.js';\nimport { createFastDomNode } from '../../base/browser/fastDomNode.js';\nimport { inputLatency } from '../../base/browser/performance.js';\nimport { BugIndicatingError, onUnexpectedError } from '../../base/common/errors.js';\nimport { PointerHandlerLastRenderData } from './controller/mouseTarget.js';\nimport { PointerHandler } from './controller/pointerHandler.js';\nimport { TextAreaHandler } from './controller/textAreaHandler.js';\nimport { RenderingContext } from './view/renderingContext.js';\nimport { ViewController } from './view/viewController.js';\nimport { ContentViewOverlays, MarginViewOverlays } from './view/viewOverlays.js';\nimport { PartFingerprints } from './view/viewPart.js';\nimport { ViewUserInputEvents } from './view/viewUserInputEvents.js';\nimport { BlockDecorations } from './viewParts/blockDecorations/blockDecorations.js';\nimport { ViewContentWidgets } from './viewParts/contentWidgets/contentWidgets.js';\nimport { CurrentLineHighlightOverlay, CurrentLineMarginHighlightOverlay } from './viewParts/currentLineHighlight/currentLineHighlight.js';\nimport { DecorationsOverlay } from './viewParts/decorations/decorations.js';\nimport { EditorScrollbar } from './viewParts/editorScrollbar/editorScrollbar.js';\nimport { GlyphMarginWidgets } from './viewParts/glyphMargin/glyphMargin.js';\nimport { IndentGuidesOverlay } from './viewParts/indentGuides/indentGuides.js';\nimport { LineNumbersOverlay } from './viewParts/lineNumbers/lineNumbers.js';\nimport { ViewLines } from './viewParts/lines/viewLines.js';\nimport { LinesDecorationsOverlay } from './viewParts/linesDecorations/linesDecorations.js';\nimport { Margin } from './viewParts/margin/margin.js';\nimport { MarginViewLineDecorationsOverlay } from './viewParts/marginDecorations/marginDecorations.js';\nimport { Minimap } from './viewParts/minimap/minimap.js';\nimport { ViewOverlayWidgets } from './viewParts/overlayWidgets/overlayWidgets.js';\nimport { DecorationsOverviewRuler } from './viewParts/overviewRuler/decorationsOverviewRuler.js';\nimport { OverviewRuler } from './viewParts/overviewRuler/overviewRuler.js';\nimport { Rulers } from './viewParts/rulers/rulers.js';\nimport { ScrollDecorationViewPart } from './viewParts/scrollDecoration/scrollDecoration.js';\nimport { SelectionsOverlay } from './viewParts/selections/selections.js';\nimport { ViewCursors } from './viewParts/viewCursors/viewCursors.js';\nimport { ViewZones } from './viewParts/viewZones/viewZones.js';\nimport { WhitespaceOverlay } from './viewParts/whitespace/whitespace.js';\nimport { Position } from '../common/core/position.js';\nimport { Range } from '../common/core/range.js';\nimport { Selection } from '../common/core/selection.js';\nimport { GlyphMarginLane } from '../common/model.js';\nimport { ViewEventHandler } from '../common/viewEventHandler.js';\nimport { ViewportData } from '../common/viewLayout/viewLinesViewportData.js';\nimport { ViewContext } from '../common/viewModel/viewContext.js';\nimport { IInstantiationService } from '../../platform/instantiation/common/instantiation.js';\nimport { getThemeTypeSelector } from '../../platform/theme/common/themeService.js';\nlet View = class View extends ViewEventHandler {\n  constructor(commandDelegate, configuration, colorTheme, model, userInputEvents, overflowWidgetsDomNode, _instantiationService) {\n    super();\n    this._instantiationService = _instantiationService;\n    // Actual mutable state\n    this._shouldRecomputeGlyphMarginLanes = false;\n    this._selections = [new Selection(1, 1, 1, 1)];\n    this._renderAnimationFrame = null;\n    const viewController = new ViewController(configuration, model, userInputEvents, commandDelegate);\n    // The view context is passed on to most classes (basically to reduce param. counts in ctors)\n    this._context = new ViewContext(configuration, colorTheme, model);\n    // Ensure the view is the first event handler in order to update the layout\n    this._context.addEventHandler(this);\n    this._viewParts = [];\n    // Keyboard handler\n    this._textAreaHandler = this._instantiationService.createInstance(TextAreaHandler, this._context, viewController, this._createTextAreaHandlerHelper());\n    this._viewParts.push(this._textAreaHandler);\n    // These two dom nodes must be constructed up front, since references are needed in the layout provider (scrolling & co.)\n    this._linesContent = createFastDomNode(document.createElement('div'));\n    this._linesContent.setClassName('lines-content' + ' monaco-editor-background');\n    this._linesContent.setPosition('absolute');\n    this.domNode = createFastDomNode(document.createElement('div'));\n    this.domNode.setClassName(this._getEditorClassName());\n    // Set role 'code' for better screen reader support https://github.com/microsoft/vscode/issues/93438\n    this.domNode.setAttribute('role', 'code');\n    this._overflowGuardContainer = createFastDomNode(document.createElement('div'));\n    PartFingerprints.write(this._overflowGuardContainer, 3 /* PartFingerprint.OverflowGuard */);\n    this._overflowGuardContainer.setClassName('overflow-guard');\n    this._scrollbar = new EditorScrollbar(this._context, this._linesContent, this.domNode, this._overflowGuardContainer);\n    this._viewParts.push(this._scrollbar);\n    // View Lines\n    this._viewLines = new ViewLines(this._context, this._linesContent);\n    // View Zones\n    this._viewZones = new ViewZones(this._context);\n    this._viewParts.push(this._viewZones);\n    // Decorations overview ruler\n    const decorationsOverviewRuler = new DecorationsOverviewRuler(this._context);\n    this._viewParts.push(decorationsOverviewRuler);\n    const scrollDecoration = new ScrollDecorationViewPart(this._context);\n    this._viewParts.push(scrollDecoration);\n    const contentViewOverlays = new ContentViewOverlays(this._context);\n    this._viewParts.push(contentViewOverlays);\n    contentViewOverlays.addDynamicOverlay(new CurrentLineHighlightOverlay(this._context));\n    contentViewOverlays.addDynamicOverlay(new SelectionsOverlay(this._context));\n    contentViewOverlays.addDynamicOverlay(new IndentGuidesOverlay(this._context));\n    contentViewOverlays.addDynamicOverlay(new DecorationsOverlay(this._context));\n    contentViewOverlays.addDynamicOverlay(new WhitespaceOverlay(this._context));\n    const marginViewOverlays = new MarginViewOverlays(this._context);\n    this._viewParts.push(marginViewOverlays);\n    marginViewOverlays.addDynamicOverlay(new CurrentLineMarginHighlightOverlay(this._context));\n    marginViewOverlays.addDynamicOverlay(new MarginViewLineDecorationsOverlay(this._context));\n    marginViewOverlays.addDynamicOverlay(new LinesDecorationsOverlay(this._context));\n    marginViewOverlays.addDynamicOverlay(new LineNumbersOverlay(this._context));\n    // Glyph margin widgets\n    this._glyphMarginWidgets = new GlyphMarginWidgets(this._context);\n    this._viewParts.push(this._glyphMarginWidgets);\n    const margin = new Margin(this._context);\n    margin.getDomNode().appendChild(this._viewZones.marginDomNode);\n    margin.getDomNode().appendChild(marginViewOverlays.getDomNode());\n    margin.getDomNode().appendChild(this._glyphMarginWidgets.domNode);\n    this._viewParts.push(margin);\n    // Content widgets\n    this._contentWidgets = new ViewContentWidgets(this._context, this.domNode);\n    this._viewParts.push(this._contentWidgets);\n    this._viewCursors = new ViewCursors(this._context);\n    this._viewParts.push(this._viewCursors);\n    // Overlay widgets\n    this._overlayWidgets = new ViewOverlayWidgets(this._context, this.domNode);\n    this._viewParts.push(this._overlayWidgets);\n    const rulers = new Rulers(this._context);\n    this._viewParts.push(rulers);\n    const blockOutline = new BlockDecorations(this._context);\n    this._viewParts.push(blockOutline);\n    const minimap = new Minimap(this._context);\n    this._viewParts.push(minimap);\n    // -------------- Wire dom nodes up\n    if (decorationsOverviewRuler) {\n      const overviewRulerData = this._scrollbar.getOverviewRulerLayoutInfo();\n      overviewRulerData.parent.insertBefore(decorationsOverviewRuler.getDomNode(), overviewRulerData.insertBefore);\n    }\n    this._linesContent.appendChild(contentViewOverlays.getDomNode());\n    this._linesContent.appendChild(rulers.domNode);\n    this._linesContent.appendChild(this._viewZones.domNode);\n    this._linesContent.appendChild(this._viewLines.getDomNode());\n    this._linesContent.appendChild(this._contentWidgets.domNode);\n    this._linesContent.appendChild(this._viewCursors.getDomNode());\n    this._overflowGuardContainer.appendChild(margin.getDomNode());\n    this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode());\n    this._overflowGuardContainer.appendChild(scrollDecoration.getDomNode());\n    this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea);\n    this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover);\n    this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode());\n    this._overflowGuardContainer.appendChild(minimap.getDomNode());\n    this._overflowGuardContainer.appendChild(blockOutline.domNode);\n    this.domNode.appendChild(this._overflowGuardContainer);\n    if (overflowWidgetsDomNode) {\n      overflowWidgetsDomNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode);\n      overflowWidgetsDomNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode);\n    } else {\n      this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode);\n      this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode);\n    }\n    this._applyLayout();\n    // Pointer handler\n    this._pointerHandler = this._register(new PointerHandler(this._context, viewController, this._createPointerHandlerHelper()));\n  }\n  _computeGlyphMarginLanes() {\n    const model = this._context.viewModel.model;\n    const laneModel = this._context.viewModel.glyphLanes;\n    let glyphs = [];\n    let maxLineNumber = 0;\n    // Add all margin decorations\n    glyphs = glyphs.concat(model.getAllMarginDecorations().map(decoration => {\n      var _a, _b, _c;\n      const lane = (_b = (_a = decoration.options.glyphMargin) === null || _a === void 0 ? void 0 : _a.position) !== null && _b !== void 0 ? _b : GlyphMarginLane.Center;\n      maxLineNumber = Math.max(maxLineNumber, decoration.range.endLineNumber);\n      return {\n        range: decoration.range,\n        lane,\n        persist: (_c = decoration.options.glyphMargin) === null || _c === void 0 ? void 0 : _c.persistLane\n      };\n    }));\n    // Add all glyph margin widgets\n    glyphs = glyphs.concat(this._glyphMarginWidgets.getWidgets().map(widget => {\n      const range = model.validateRange(widget.preference.range);\n      maxLineNumber = Math.max(maxLineNumber, range.endLineNumber);\n      return {\n        range,\n        lane: widget.preference.lane\n      };\n    }));\n    // Sorted by their start position\n    glyphs.sort((a, b) => Range.compareRangesUsingStarts(a.range, b.range));\n    laneModel.reset(maxLineNumber);\n    for (const glyph of glyphs) {\n      laneModel.push(glyph.lane, glyph.range, glyph.persist);\n    }\n    return laneModel;\n  }\n  _createPointerHandlerHelper() {\n    return {\n      viewDomNode: this.domNode.domNode,\n      linesContentDomNode: this._linesContent.domNode,\n      viewLinesDomNode: this._viewLines.getDomNode().domNode,\n      focusTextArea: () => {\n        this.focus();\n      },\n      dispatchTextAreaEvent: event => {\n        this._textAreaHandler.textArea.domNode.dispatchEvent(event);\n      },\n      getLastRenderData: () => {\n        const lastViewCursorsRenderData = this._viewCursors.getLastRenderData() || [];\n        const lastTextareaPosition = this._textAreaHandler.getLastRenderData();\n        return new PointerHandlerLastRenderData(lastViewCursorsRenderData, lastTextareaPosition);\n      },\n      renderNow: () => {\n        this.render(true, false);\n      },\n      shouldSuppressMouseDownOnViewZone: viewZoneId => {\n        return this._viewZones.shouldSuppressMouseDownOnViewZone(viewZoneId);\n      },\n      shouldSuppressMouseDownOnWidget: widgetId => {\n        return this._contentWidgets.shouldSuppressMouseDownOnWidget(widgetId);\n      },\n      getPositionFromDOMInfo: (spanNode, offset) => {\n        this._flushAccumulatedAndRenderNow();\n        return this._viewLines.getPositionFromDOMInfo(spanNode, offset);\n      },\n      visibleRangeForPosition: (lineNumber, column) => {\n        this._flushAccumulatedAndRenderNow();\n        return this._viewLines.visibleRangeForPosition(new Position(lineNumber, column));\n      },\n      getLineWidth: lineNumber => {\n        this._flushAccumulatedAndRenderNow();\n        return this._viewLines.getLineWidth(lineNumber);\n      }\n    };\n  }\n  _createTextAreaHandlerHelper() {\n    return {\n      visibleRangeForPosition: position => {\n        this._flushAccumulatedAndRenderNow();\n        return this._viewLines.visibleRangeForPosition(position);\n      }\n    };\n  }\n  _applyLayout() {\n    const options = this._context.configuration.options;\n    const layoutInfo = options.get(143 /* EditorOption.layoutInfo */);\n    this.domNode.setWidth(layoutInfo.width);\n    this.domNode.setHeight(layoutInfo.height);\n    this._overflowGuardContainer.setWidth(layoutInfo.width);\n    this._overflowGuardContainer.setHeight(layoutInfo.height);\n    this._linesContent.setWidth(1000000);\n    this._linesContent.setHeight(1000000);\n  }\n  _getEditorClassName() {\n    const focused = this._textAreaHandler.isFocused() ? ' focused' : '';\n    return this._context.configuration.options.get(140 /* EditorOption.editorClassName */) + ' ' + getThemeTypeSelector(this._context.theme.type) + focused;\n  }\n  // --- begin event handlers\n  handleEvents(events) {\n    super.handleEvents(events);\n    this._scheduleRender();\n  }\n  onConfigurationChanged(e) {\n    this.domNode.setClassName(this._getEditorClassName());\n    this._applyLayout();\n    return false;\n  }\n  onCursorStateChanged(e) {\n    this._selections = e.selections;\n    return false;\n  }\n  onDecorationsChanged(e) {\n    if (e.affectsGlyphMargin) {\n      this._shouldRecomputeGlyphMarginLanes = true;\n    }\n    return false;\n  }\n  onFocusChanged(e) {\n    this.domNode.setClassName(this._getEditorClassName());\n    return false;\n  }\n  onThemeChanged(e) {\n    this._context.theme.update(e.theme);\n    this.domNode.setClassName(this._getEditorClassName());\n    return false;\n  }\n  // --- end event handlers\n  dispose() {\n    if (this._renderAnimationFrame !== null) {\n      this._renderAnimationFrame.dispose();\n      this._renderAnimationFrame = null;\n    }\n    this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove();\n    this._context.removeEventHandler(this);\n    this._viewLines.dispose();\n    // Destroy view parts\n    for (const viewPart of this._viewParts) {\n      viewPart.dispose();\n    }\n    super.dispose();\n  }\n  _scheduleRender() {\n    if (this._store.isDisposed) {\n      throw new BugIndicatingError();\n    }\n    if (this._renderAnimationFrame === null) {\n      const rendering = this._createCoordinatedRendering();\n      this._renderAnimationFrame = EditorRenderingCoordinator.INSTANCE.scheduleCoordinatedRendering({\n        window: dom.getWindow(this.domNode.domNode),\n        prepareRenderText: () => {\n          if (this._store.isDisposed) {\n            throw new BugIndicatingError();\n          }\n          try {\n            return rendering.prepareRenderText();\n          } finally {\n            this._renderAnimationFrame = null;\n          }\n        },\n        renderText: () => {\n          if (this._store.isDisposed) {\n            throw new BugIndicatingError();\n          }\n          return rendering.renderText();\n        },\n        prepareRender: (viewParts, ctx) => {\n          if (this._store.isDisposed) {\n            throw new BugIndicatingError();\n          }\n          return rendering.prepareRender(viewParts, ctx);\n        },\n        render: (viewParts, ctx) => {\n          if (this._store.isDisposed) {\n            throw new BugIndicatingError();\n          }\n          return rendering.render(viewParts, ctx);\n        }\n      });\n    }\n  }\n  _flushAccumulatedAndRenderNow() {\n    const rendering = this._createCoordinatedRendering();\n    safeInvokeNoArg(() => rendering.prepareRenderText());\n    const data = safeInvokeNoArg(() => rendering.renderText());\n    if (data) {\n      const [viewParts, ctx] = data;\n      safeInvokeNoArg(() => rendering.prepareRender(viewParts, ctx));\n      safeInvokeNoArg(() => rendering.render(viewParts, ctx));\n    }\n  }\n  _getViewPartsToRender() {\n    const result = [];\n    let resultLen = 0;\n    for (const viewPart of this._viewParts) {\n      if (viewPart.shouldRender()) {\n        result[resultLen++] = viewPart;\n      }\n    }\n    return result;\n  }\n  _createCoordinatedRendering() {\n    return {\n      prepareRenderText: () => {\n        if (this._shouldRecomputeGlyphMarginLanes) {\n          this._shouldRecomputeGlyphMarginLanes = false;\n          const model = this._computeGlyphMarginLanes();\n          this._context.configuration.setGlyphMarginDecorationLaneCount(model.requiredLanes);\n        }\n        inputLatency.onRenderStart();\n      },\n      renderText: () => {\n        if (!this.domNode.domNode.isConnected) {\n          return null;\n        }\n        let viewPartsToRender = this._getViewPartsToRender();\n        if (!this._viewLines.shouldRender() && viewPartsToRender.length === 0) {\n          // Nothing to render\n          return null;\n        }\n        const partialViewportData = this._context.viewLayout.getLinesViewportData();\n        this._context.viewModel.setViewport(partialViewportData.startLineNumber, partialViewportData.endLineNumber, partialViewportData.centeredLineNumber);\n        const viewportData = new ViewportData(this._selections, partialViewportData, this._context.viewLayout.getWhitespaceViewportData(), this._context.viewModel);\n        if (this._contentWidgets.shouldRender()) {\n          // Give the content widgets a chance to set their max width before a possible synchronous layout\n          this._contentWidgets.onBeforeRender(viewportData);\n        }\n        if (this._viewLines.shouldRender()) {\n          this._viewLines.renderText(viewportData);\n          this._viewLines.onDidRender();\n          // Rendering of viewLines might cause scroll events to occur, so collect view parts to render again\n          viewPartsToRender = this._getViewPartsToRender();\n        }\n        return [viewPartsToRender, new RenderingContext(this._context.viewLayout, viewportData, this._viewLines)];\n      },\n      prepareRender: (viewPartsToRender, ctx) => {\n        for (const viewPart of viewPartsToRender) {\n          viewPart.prepareRender(ctx);\n        }\n      },\n      render: (viewPartsToRender, ctx) => {\n        for (const viewPart of viewPartsToRender) {\n          viewPart.render(ctx);\n          viewPart.onDidRender();\n        }\n      }\n    };\n  }\n  // --- BEGIN CodeEditor helpers\n  delegateVerticalScrollbarPointerDown(browserEvent) {\n    this._scrollbar.delegateVerticalScrollbarPointerDown(browserEvent);\n  }\n  delegateScrollFromMouseWheelEvent(browserEvent) {\n    this._scrollbar.delegateScrollFromMouseWheelEvent(browserEvent);\n  }\n  restoreState(scrollPosition) {\n    this._context.viewModel.viewLayout.setScrollPosition({\n      scrollTop: scrollPosition.scrollTop,\n      scrollLeft: scrollPosition.scrollLeft\n    }, 1 /* ScrollType.Immediate */);\n    this._context.viewModel.visibleLinesStabilized();\n  }\n  getOffsetForColumn(modelLineNumber, modelColumn) {\n    const modelPosition = this._context.viewModel.model.validatePosition({\n      lineNumber: modelLineNumber,\n      column: modelColumn\n    });\n    const viewPosition = this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(modelPosition);\n    this._flushAccumulatedAndRenderNow();\n    const visibleRange = this._viewLines.visibleRangeForPosition(new Position(viewPosition.lineNumber, viewPosition.column));\n    if (!visibleRange) {\n      return -1;\n    }\n    return visibleRange.left;\n  }\n  getTargetAtClientPoint(clientX, clientY) {\n    const mouseTarget = this._pointerHandler.getTargetAtClientPoint(clientX, clientY);\n    if (!mouseTarget) {\n      return null;\n    }\n    return ViewUserInputEvents.convertViewToModelMouseTarget(mouseTarget, this._context.viewModel.coordinatesConverter);\n  }\n  createOverviewRuler(cssClassName) {\n    return new OverviewRuler(this._context, cssClassName);\n  }\n  change(callback) {\n    this._viewZones.changeViewZones(callback);\n    this._scheduleRender();\n  }\n  render(now, everything) {\n    if (everything) {\n      // Force everything to render...\n      this._viewLines.forceShouldRender();\n      for (const viewPart of this._viewParts) {\n        viewPart.forceShouldRender();\n      }\n    }\n    if (now) {\n      this._flushAccumulatedAndRenderNow();\n    } else {\n      this._scheduleRender();\n    }\n  }\n  writeScreenReaderContent(reason) {\n    this._textAreaHandler.writeScreenReaderContent(reason);\n  }\n  focus() {\n    this._textAreaHandler.focusTextArea();\n  }\n  isFocused() {\n    return this._textAreaHandler.isFocused();\n  }\n  setAriaOptions(options) {\n    this._textAreaHandler.setAriaOptions(options);\n  }\n  addContentWidget(widgetData) {\n    this._contentWidgets.addWidget(widgetData.widget);\n    this.layoutContentWidget(widgetData);\n    this._scheduleRender();\n  }\n  layoutContentWidget(widgetData) {\n    var _a, _b, _c, _d, _e, _f, _g, _h;\n    this._contentWidgets.setWidgetPosition(widgetData.widget, (_b = (_a = widgetData.position) === null || _a === void 0 ? void 0 : _a.position) !== null && _b !== void 0 ? _b : null, (_d = (_c = widgetData.position) === null || _c === void 0 ? void 0 : _c.secondaryPosition) !== null && _d !== void 0 ? _d : null, (_f = (_e = widgetData.position) === null || _e === void 0 ? void 0 : _e.preference) !== null && _f !== void 0 ? _f : null, (_h = (_g = widgetData.position) === null || _g === void 0 ? void 0 : _g.positionAffinity) !== null && _h !== void 0 ? _h : null);\n    this._scheduleRender();\n  }\n  removeContentWidget(widgetData) {\n    this._contentWidgets.removeWidget(widgetData.widget);\n    this._scheduleRender();\n  }\n  addOverlayWidget(widgetData) {\n    this._overlayWidgets.addWidget(widgetData.widget);\n    this.layoutOverlayWidget(widgetData);\n    this._scheduleRender();\n  }\n  layoutOverlayWidget(widgetData) {\n    const newPreference = widgetData.position ? widgetData.position.preference : null;\n    const shouldRender = this._overlayWidgets.setWidgetPosition(widgetData.widget, newPreference);\n    if (shouldRender) {\n      this._scheduleRender();\n    }\n  }\n  removeOverlayWidget(widgetData) {\n    this._overlayWidgets.removeWidget(widgetData.widget);\n    this._scheduleRender();\n  }\n  addGlyphMarginWidget(widgetData) {\n    this._glyphMarginWidgets.addWidget(widgetData.widget);\n    this._shouldRecomputeGlyphMarginLanes = true;\n    this._scheduleRender();\n  }\n  layoutGlyphMarginWidget(widgetData) {\n    const newPreference = widgetData.position;\n    const shouldRender = this._glyphMarginWidgets.setWidgetPosition(widgetData.widget, newPreference);\n    if (shouldRender) {\n      this._shouldRecomputeGlyphMarginLanes = true;\n      this._scheduleRender();\n    }\n  }\n  removeGlyphMarginWidget(widgetData) {\n    this._glyphMarginWidgets.removeWidget(widgetData.widget);\n    this._shouldRecomputeGlyphMarginLanes = true;\n    this._scheduleRender();\n  }\n};\nView = __decorate([__param(6, IInstantiationService)], View);\nexport { View };\nfunction safeInvokeNoArg(func) {\n  try {\n    return func();\n  } catch (e) {\n    onUnexpectedError(e);\n    return null;\n  }\n}\nclass EditorRenderingCoordinator {\n  constructor() {\n    this._coordinatedRenderings = [];\n    this._animationFrameRunners = new Map();\n  }\n  scheduleCoordinatedRendering(rendering) {\n    this._coordinatedRenderings.push(rendering);\n    this._scheduleRender(rendering.window);\n    return {\n      dispose: () => {\n        const renderingIndex = this._coordinatedRenderings.indexOf(rendering);\n        if (renderingIndex === -1) {\n          return;\n        }\n        this._coordinatedRenderings.splice(renderingIndex, 1);\n        if (this._coordinatedRenderings.length === 0) {\n          // There are no more renderings to coordinate => cancel animation frames\n          for (const [_, disposable] of this._animationFrameRunners) {\n            disposable.dispose();\n          }\n          this._animationFrameRunners.clear();\n        }\n      }\n    };\n  }\n  _scheduleRender(window) {\n    if (!this._animationFrameRunners.has(window)) {\n      const runner = () => {\n        this._animationFrameRunners.delete(window);\n        this._onRenderScheduled();\n      };\n      this._animationFrameRunners.set(window, dom.runAtThisOrScheduleAtNextAnimationFrame(window, runner, 100));\n    }\n  }\n  _onRenderScheduled() {\n    const coordinatedRenderings = this._coordinatedRenderings.slice(0);\n    this._coordinatedRenderings = [];\n    for (const rendering of coordinatedRenderings) {\n      safeInvokeNoArg(() => rendering.prepareRenderText());\n    }\n    const datas = [];\n    for (let i = 0, len = coordinatedRenderings.length; i < len; i++) {\n      const rendering = coordinatedRenderings[i];\n      datas[i] = safeInvokeNoArg(() => rendering.renderText());\n    }\n    for (let i = 0, len = coordinatedRenderings.length; i < len; i++) {\n      const rendering = coordinatedRenderings[i];\n      const data = datas[i];\n      if (!data) {\n        continue;\n      }\n      const [viewParts, ctx] = data;\n      safeInvokeNoArg(() => rendering.prepareRender(viewParts, ctx));\n    }\n    for (let i = 0, len = coordinatedRenderings.length; i < len; i++) {\n      const rendering = coordinatedRenderings[i];\n      const data = datas[i];\n      if (!data) {\n        continue;\n      }\n      const [viewParts, ctx] = data;\n      safeInvokeNoArg(() => rendering.render(viewParts, ctx));\n    }\n  }\n}\nEditorRenderingCoordinator.INSTANCE = new EditorRenderingCoordinator();","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","dom","createFastDomNode","inputLatency","BugIndicatingError","onUnexpectedError","PointerHandlerLastRenderData","PointerHandler","TextAreaHandler","RenderingContext","ViewController","ContentViewOverlays","MarginViewOverlays","PartFingerprints","ViewUserInputEvents","BlockDecorations","ViewContentWidgets","CurrentLineHighlightOverlay","CurrentLineMarginHighlightOverlay","DecorationsOverlay","EditorScrollbar","GlyphMarginWidgets","IndentGuidesOverlay","LineNumbersOverlay","ViewLines","LinesDecorationsOverlay","Margin","MarginViewLineDecorationsOverlay","Minimap","ViewOverlayWidgets","DecorationsOverviewRuler","OverviewRuler","Rulers","ScrollDecorationViewPart","SelectionsOverlay","ViewCursors","ViewZones","WhitespaceOverlay","Position","Range","Selection","GlyphMarginLane","ViewEventHandler","ViewportData","ViewContext","IInstantiationService","getThemeTypeSelector","View","constructor","commandDelegate","configuration","colorTheme","model","userInputEvents","overflowWidgetsDomNode","_instantiationService","_shouldRecomputeGlyphMarginLanes","_selections","_renderAnimationFrame","viewController","_context","addEventHandler","_viewParts","_textAreaHandler","createInstance","_createTextAreaHandlerHelper","push","_linesContent","document","createElement","setClassName","setPosition","domNode","_getEditorClassName","setAttribute","_overflowGuardContainer","write","_scrollbar","_viewLines","_viewZones","decorationsOverviewRuler","scrollDecoration","contentViewOverlays","addDynamicOverlay","marginViewOverlays","_glyphMarginWidgets","margin","getDomNode","appendChild","marginDomNode","_contentWidgets","_viewCursors","_overlayWidgets","rulers","blockOutline","minimap","overviewRulerData","getOverviewRulerLayoutInfo","parent","insertBefore","textArea","textAreaCover","overflowingContentWidgetsDomNode","overflowingOverlayWidgetsDomNode","_applyLayout","_pointerHandler","_register","_createPointerHandlerHelper","_computeGlyphMarginLanes","viewModel","laneModel","glyphLanes","glyphs","maxLineNumber","concat","getAllMarginDecorations","map","decoration","_a","_b","_c","lane","options","glyphMargin","position","Center","Math","max","range","endLineNumber","persist","persistLane","getWidgets","widget","validateRange","preference","sort","a","b","compareRangesUsingStarts","reset","glyph","viewDomNode","linesContentDomNode","viewLinesDomNode","focusTextArea","focus","dispatchTextAreaEvent","event","dispatchEvent","getLastRenderData","lastViewCursorsRenderData","lastTextareaPosition","renderNow","render","shouldSuppressMouseDownOnViewZone","viewZoneId","shouldSuppressMouseDownOnWidget","widgetId","getPositionFromDOMInfo","spanNode","offset","_flushAccumulatedAndRenderNow","visibleRangeForPosition","lineNumber","column","getLineWidth","layoutInfo","get","setWidth","width","setHeight","height","focused","isFocused","theme","type","handleEvents","events","_scheduleRender","onConfigurationChanged","e","onCursorStateChanged","selections","onDecorationsChanged","affectsGlyphMargin","onFocusChanged","onThemeChanged","update","dispose","remove","removeEventHandler","viewPart","_store","isDisposed","rendering","_createCoordinatedRendering","EditorRenderingCoordinator","INSTANCE","scheduleCoordinatedRendering","window","getWindow","prepareRenderText","renderText","prepareRender","viewParts","ctx","safeInvokeNoArg","data","_getViewPartsToRender","result","resultLen","shouldRender","setGlyphMarginDecorationLaneCount","requiredLanes","onRenderStart","isConnected","viewPartsToRender","partialViewportData","viewLayout","getLinesViewportData","setViewport","startLineNumber","centeredLineNumber","viewportData","getWhitespaceViewportData","onBeforeRender","onDidRender","delegateVerticalScrollbarPointerDown","browserEvent","delegateScrollFromMouseWheelEvent","restoreState","scrollPosition","setScrollPosition","scrollTop","scrollLeft","visibleLinesStabilized","getOffsetForColumn","modelLineNumber","modelColumn","modelPosition","validatePosition","viewPosition","coordinatesConverter","convertModelPositionToViewPosition","visibleRange","left","getTargetAtClientPoint","clientX","clientY","mouseTarget","convertViewToModelMouseTarget","createOverviewRuler","cssClassName","change","callback","changeViewZones","now","everything","forceShouldRender","writeScreenReaderContent","reason","setAriaOptions","addContentWidget","widgetData","addWidget","layoutContentWidget","_d","_e","_f","_g","_h","setWidgetPosition","secondaryPosition","positionAffinity","removeContentWidget","removeWidget","addOverlayWidget","layoutOverlayWidget","newPreference","removeOverlayWidget","addGlyphMarginWidget","layoutGlyphMarginWidget","removeGlyphMarginWidget","func","_coordinatedRenderings","_animationFrameRunners","Map","renderingIndex","indexOf","splice","_","disposable","clear","has","runner","delete","_onRenderScheduled","set","runAtThisOrScheduleAtNextAnimationFrame","coordinatedRenderings","slice","datas","len"],"sources":["D:/yupi/OJ System/OJ System/feioj-front/node_modules/monaco-editor/esm/vs/editor/browser/view.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../base/browser/dom.js';\nimport { createFastDomNode } from '../../base/browser/fastDomNode.js';\nimport { inputLatency } from '../../base/browser/performance.js';\nimport { BugIndicatingError, onUnexpectedError } from '../../base/common/errors.js';\nimport { PointerHandlerLastRenderData } from './controller/mouseTarget.js';\nimport { PointerHandler } from './controller/pointerHandler.js';\nimport { TextAreaHandler } from './controller/textAreaHandler.js';\nimport { RenderingContext } from './view/renderingContext.js';\nimport { ViewController } from './view/viewController.js';\nimport { ContentViewOverlays, MarginViewOverlays } from './view/viewOverlays.js';\nimport { PartFingerprints } from './view/viewPart.js';\nimport { ViewUserInputEvents } from './view/viewUserInputEvents.js';\nimport { BlockDecorations } from './viewParts/blockDecorations/blockDecorations.js';\nimport { ViewContentWidgets } from './viewParts/contentWidgets/contentWidgets.js';\nimport { CurrentLineHighlightOverlay, CurrentLineMarginHighlightOverlay } from './viewParts/currentLineHighlight/currentLineHighlight.js';\nimport { DecorationsOverlay } from './viewParts/decorations/decorations.js';\nimport { EditorScrollbar } from './viewParts/editorScrollbar/editorScrollbar.js';\nimport { GlyphMarginWidgets } from './viewParts/glyphMargin/glyphMargin.js';\nimport { IndentGuidesOverlay } from './viewParts/indentGuides/indentGuides.js';\nimport { LineNumbersOverlay } from './viewParts/lineNumbers/lineNumbers.js';\nimport { ViewLines } from './viewParts/lines/viewLines.js';\nimport { LinesDecorationsOverlay } from './viewParts/linesDecorations/linesDecorations.js';\nimport { Margin } from './viewParts/margin/margin.js';\nimport { MarginViewLineDecorationsOverlay } from './viewParts/marginDecorations/marginDecorations.js';\nimport { Minimap } from './viewParts/minimap/minimap.js';\nimport { ViewOverlayWidgets } from './viewParts/overlayWidgets/overlayWidgets.js';\nimport { DecorationsOverviewRuler } from './viewParts/overviewRuler/decorationsOverviewRuler.js';\nimport { OverviewRuler } from './viewParts/overviewRuler/overviewRuler.js';\nimport { Rulers } from './viewParts/rulers/rulers.js';\nimport { ScrollDecorationViewPart } from './viewParts/scrollDecoration/scrollDecoration.js';\nimport { SelectionsOverlay } from './viewParts/selections/selections.js';\nimport { ViewCursors } from './viewParts/viewCursors/viewCursors.js';\nimport { ViewZones } from './viewParts/viewZones/viewZones.js';\nimport { WhitespaceOverlay } from './viewParts/whitespace/whitespace.js';\nimport { Position } from '../common/core/position.js';\nimport { Range } from '../common/core/range.js';\nimport { Selection } from '../common/core/selection.js';\nimport { GlyphMarginLane } from '../common/model.js';\nimport { ViewEventHandler } from '../common/viewEventHandler.js';\nimport { ViewportData } from '../common/viewLayout/viewLinesViewportData.js';\nimport { ViewContext } from '../common/viewModel/viewContext.js';\nimport { IInstantiationService } from '../../platform/instantiation/common/instantiation.js';\nimport { getThemeTypeSelector } from '../../platform/theme/common/themeService.js';\nlet View = class View extends ViewEventHandler {\n    constructor(commandDelegate, configuration, colorTheme, model, userInputEvents, overflowWidgetsDomNode, _instantiationService) {\n        super();\n        this._instantiationService = _instantiationService;\n        // Actual mutable state\n        this._shouldRecomputeGlyphMarginLanes = false;\n        this._selections = [new Selection(1, 1, 1, 1)];\n        this._renderAnimationFrame = null;\n        const viewController = new ViewController(configuration, model, userInputEvents, commandDelegate);\n        // The view context is passed on to most classes (basically to reduce param. counts in ctors)\n        this._context = new ViewContext(configuration, colorTheme, model);\n        // Ensure the view is the first event handler in order to update the layout\n        this._context.addEventHandler(this);\n        this._viewParts = [];\n        // Keyboard handler\n        this._textAreaHandler = this._instantiationService.createInstance(TextAreaHandler, this._context, viewController, this._createTextAreaHandlerHelper());\n        this._viewParts.push(this._textAreaHandler);\n        // These two dom nodes must be constructed up front, since references are needed in the layout provider (scrolling & co.)\n        this._linesContent = createFastDomNode(document.createElement('div'));\n        this._linesContent.setClassName('lines-content' + ' monaco-editor-background');\n        this._linesContent.setPosition('absolute');\n        this.domNode = createFastDomNode(document.createElement('div'));\n        this.domNode.setClassName(this._getEditorClassName());\n        // Set role 'code' for better screen reader support https://github.com/microsoft/vscode/issues/93438\n        this.domNode.setAttribute('role', 'code');\n        this._overflowGuardContainer = createFastDomNode(document.createElement('div'));\n        PartFingerprints.write(this._overflowGuardContainer, 3 /* PartFingerprint.OverflowGuard */);\n        this._overflowGuardContainer.setClassName('overflow-guard');\n        this._scrollbar = new EditorScrollbar(this._context, this._linesContent, this.domNode, this._overflowGuardContainer);\n        this._viewParts.push(this._scrollbar);\n        // View Lines\n        this._viewLines = new ViewLines(this._context, this._linesContent);\n        // View Zones\n        this._viewZones = new ViewZones(this._context);\n        this._viewParts.push(this._viewZones);\n        // Decorations overview ruler\n        const decorationsOverviewRuler = new DecorationsOverviewRuler(this._context);\n        this._viewParts.push(decorationsOverviewRuler);\n        const scrollDecoration = new ScrollDecorationViewPart(this._context);\n        this._viewParts.push(scrollDecoration);\n        const contentViewOverlays = new ContentViewOverlays(this._context);\n        this._viewParts.push(contentViewOverlays);\n        contentViewOverlays.addDynamicOverlay(new CurrentLineHighlightOverlay(this._context));\n        contentViewOverlays.addDynamicOverlay(new SelectionsOverlay(this._context));\n        contentViewOverlays.addDynamicOverlay(new IndentGuidesOverlay(this._context));\n        contentViewOverlays.addDynamicOverlay(new DecorationsOverlay(this._context));\n        contentViewOverlays.addDynamicOverlay(new WhitespaceOverlay(this._context));\n        const marginViewOverlays = new MarginViewOverlays(this._context);\n        this._viewParts.push(marginViewOverlays);\n        marginViewOverlays.addDynamicOverlay(new CurrentLineMarginHighlightOverlay(this._context));\n        marginViewOverlays.addDynamicOverlay(new MarginViewLineDecorationsOverlay(this._context));\n        marginViewOverlays.addDynamicOverlay(new LinesDecorationsOverlay(this._context));\n        marginViewOverlays.addDynamicOverlay(new LineNumbersOverlay(this._context));\n        // Glyph margin widgets\n        this._glyphMarginWidgets = new GlyphMarginWidgets(this._context);\n        this._viewParts.push(this._glyphMarginWidgets);\n        const margin = new Margin(this._context);\n        margin.getDomNode().appendChild(this._viewZones.marginDomNode);\n        margin.getDomNode().appendChild(marginViewOverlays.getDomNode());\n        margin.getDomNode().appendChild(this._glyphMarginWidgets.domNode);\n        this._viewParts.push(margin);\n        // Content widgets\n        this._contentWidgets = new ViewContentWidgets(this._context, this.domNode);\n        this._viewParts.push(this._contentWidgets);\n        this._viewCursors = new ViewCursors(this._context);\n        this._viewParts.push(this._viewCursors);\n        // Overlay widgets\n        this._overlayWidgets = new ViewOverlayWidgets(this._context, this.domNode);\n        this._viewParts.push(this._overlayWidgets);\n        const rulers = new Rulers(this._context);\n        this._viewParts.push(rulers);\n        const blockOutline = new BlockDecorations(this._context);\n        this._viewParts.push(blockOutline);\n        const minimap = new Minimap(this._context);\n        this._viewParts.push(minimap);\n        // -------------- Wire dom nodes up\n        if (decorationsOverviewRuler) {\n            const overviewRulerData = this._scrollbar.getOverviewRulerLayoutInfo();\n            overviewRulerData.parent.insertBefore(decorationsOverviewRuler.getDomNode(), overviewRulerData.insertBefore);\n        }\n        this._linesContent.appendChild(contentViewOverlays.getDomNode());\n        this._linesContent.appendChild(rulers.domNode);\n        this._linesContent.appendChild(this._viewZones.domNode);\n        this._linesContent.appendChild(this._viewLines.getDomNode());\n        this._linesContent.appendChild(this._contentWidgets.domNode);\n        this._linesContent.appendChild(this._viewCursors.getDomNode());\n        this._overflowGuardContainer.appendChild(margin.getDomNode());\n        this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode());\n        this._overflowGuardContainer.appendChild(scrollDecoration.getDomNode());\n        this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea);\n        this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover);\n        this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode());\n        this._overflowGuardContainer.appendChild(minimap.getDomNode());\n        this._overflowGuardContainer.appendChild(blockOutline.domNode);\n        this.domNode.appendChild(this._overflowGuardContainer);\n        if (overflowWidgetsDomNode) {\n            overflowWidgetsDomNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode);\n            overflowWidgetsDomNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode);\n        }\n        else {\n            this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode);\n            this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode);\n        }\n        this._applyLayout();\n        // Pointer handler\n        this._pointerHandler = this._register(new PointerHandler(this._context, viewController, this._createPointerHandlerHelper()));\n    }\n    _computeGlyphMarginLanes() {\n        const model = this._context.viewModel.model;\n        const laneModel = this._context.viewModel.glyphLanes;\n        let glyphs = [];\n        let maxLineNumber = 0;\n        // Add all margin decorations\n        glyphs = glyphs.concat(model.getAllMarginDecorations().map((decoration) => {\n            var _a, _b, _c;\n            const lane = (_b = (_a = decoration.options.glyphMargin) === null || _a === void 0 ? void 0 : _a.position) !== null && _b !== void 0 ? _b : GlyphMarginLane.Center;\n            maxLineNumber = Math.max(maxLineNumber, decoration.range.endLineNumber);\n            return { range: decoration.range, lane, persist: (_c = decoration.options.glyphMargin) === null || _c === void 0 ? void 0 : _c.persistLane };\n        }));\n        // Add all glyph margin widgets\n        glyphs = glyphs.concat(this._glyphMarginWidgets.getWidgets().map((widget) => {\n            const range = model.validateRange(widget.preference.range);\n            maxLineNumber = Math.max(maxLineNumber, range.endLineNumber);\n            return { range, lane: widget.preference.lane };\n        }));\n        // Sorted by their start position\n        glyphs.sort((a, b) => Range.compareRangesUsingStarts(a.range, b.range));\n        laneModel.reset(maxLineNumber);\n        for (const glyph of glyphs) {\n            laneModel.push(glyph.lane, glyph.range, glyph.persist);\n        }\n        return laneModel;\n    }\n    _createPointerHandlerHelper() {\n        return {\n            viewDomNode: this.domNode.domNode,\n            linesContentDomNode: this._linesContent.domNode,\n            viewLinesDomNode: this._viewLines.getDomNode().domNode,\n            focusTextArea: () => {\n                this.focus();\n            },\n            dispatchTextAreaEvent: (event) => {\n                this._textAreaHandler.textArea.domNode.dispatchEvent(event);\n            },\n            getLastRenderData: () => {\n                const lastViewCursorsRenderData = this._viewCursors.getLastRenderData() || [];\n                const lastTextareaPosition = this._textAreaHandler.getLastRenderData();\n                return new PointerHandlerLastRenderData(lastViewCursorsRenderData, lastTextareaPosition);\n            },\n            renderNow: () => {\n                this.render(true, false);\n            },\n            shouldSuppressMouseDownOnViewZone: (viewZoneId) => {\n                return this._viewZones.shouldSuppressMouseDownOnViewZone(viewZoneId);\n            },\n            shouldSuppressMouseDownOnWidget: (widgetId) => {\n                return this._contentWidgets.shouldSuppressMouseDownOnWidget(widgetId);\n            },\n            getPositionFromDOMInfo: (spanNode, offset) => {\n                this._flushAccumulatedAndRenderNow();\n                return this._viewLines.getPositionFromDOMInfo(spanNode, offset);\n            },\n            visibleRangeForPosition: (lineNumber, column) => {\n                this._flushAccumulatedAndRenderNow();\n                return this._viewLines.visibleRangeForPosition(new Position(lineNumber, column));\n            },\n            getLineWidth: (lineNumber) => {\n                this._flushAccumulatedAndRenderNow();\n                return this._viewLines.getLineWidth(lineNumber);\n            }\n        };\n    }\n    _createTextAreaHandlerHelper() {\n        return {\n            visibleRangeForPosition: (position) => {\n                this._flushAccumulatedAndRenderNow();\n                return this._viewLines.visibleRangeForPosition(position);\n            }\n        };\n    }\n    _applyLayout() {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(143 /* EditorOption.layoutInfo */);\n        this.domNode.setWidth(layoutInfo.width);\n        this.domNode.setHeight(layoutInfo.height);\n        this._overflowGuardContainer.setWidth(layoutInfo.width);\n        this._overflowGuardContainer.setHeight(layoutInfo.height);\n        this._linesContent.setWidth(1000000);\n        this._linesContent.setHeight(1000000);\n    }\n    _getEditorClassName() {\n        const focused = this._textAreaHandler.isFocused() ? ' focused' : '';\n        return this._context.configuration.options.get(140 /* EditorOption.editorClassName */) + ' ' + getThemeTypeSelector(this._context.theme.type) + focused;\n    }\n    // --- begin event handlers\n    handleEvents(events) {\n        super.handleEvents(events);\n        this._scheduleRender();\n    }\n    onConfigurationChanged(e) {\n        this.domNode.setClassName(this._getEditorClassName());\n        this._applyLayout();\n        return false;\n    }\n    onCursorStateChanged(e) {\n        this._selections = e.selections;\n        return false;\n    }\n    onDecorationsChanged(e) {\n        if (e.affectsGlyphMargin) {\n            this._shouldRecomputeGlyphMarginLanes = true;\n        }\n        return false;\n    }\n    onFocusChanged(e) {\n        this.domNode.setClassName(this._getEditorClassName());\n        return false;\n    }\n    onThemeChanged(e) {\n        this._context.theme.update(e.theme);\n        this.domNode.setClassName(this._getEditorClassName());\n        return false;\n    }\n    // --- end event handlers\n    dispose() {\n        if (this._renderAnimationFrame !== null) {\n            this._renderAnimationFrame.dispose();\n            this._renderAnimationFrame = null;\n        }\n        this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove();\n        this._context.removeEventHandler(this);\n        this._viewLines.dispose();\n        // Destroy view parts\n        for (const viewPart of this._viewParts) {\n            viewPart.dispose();\n        }\n        super.dispose();\n    }\n    _scheduleRender() {\n        if (this._store.isDisposed) {\n            throw new BugIndicatingError();\n        }\n        if (this._renderAnimationFrame === null) {\n            const rendering = this._createCoordinatedRendering();\n            this._renderAnimationFrame = EditorRenderingCoordinator.INSTANCE.scheduleCoordinatedRendering({\n                window: dom.getWindow(this.domNode.domNode),\n                prepareRenderText: () => {\n                    if (this._store.isDisposed) {\n                        throw new BugIndicatingError();\n                    }\n                    try {\n                        return rendering.prepareRenderText();\n                    }\n                    finally {\n                        this._renderAnimationFrame = null;\n                    }\n                },\n                renderText: () => {\n                    if (this._store.isDisposed) {\n                        throw new BugIndicatingError();\n                    }\n                    return rendering.renderText();\n                },\n                prepareRender: (viewParts, ctx) => {\n                    if (this._store.isDisposed) {\n                        throw new BugIndicatingError();\n                    }\n                    return rendering.prepareRender(viewParts, ctx);\n                },\n                render: (viewParts, ctx) => {\n                    if (this._store.isDisposed) {\n                        throw new BugIndicatingError();\n                    }\n                    return rendering.render(viewParts, ctx);\n                }\n            });\n        }\n    }\n    _flushAccumulatedAndRenderNow() {\n        const rendering = this._createCoordinatedRendering();\n        safeInvokeNoArg(() => rendering.prepareRenderText());\n        const data = safeInvokeNoArg(() => rendering.renderText());\n        if (data) {\n            const [viewParts, ctx] = data;\n            safeInvokeNoArg(() => rendering.prepareRender(viewParts, ctx));\n            safeInvokeNoArg(() => rendering.render(viewParts, ctx));\n        }\n    }\n    _getViewPartsToRender() {\n        const result = [];\n        let resultLen = 0;\n        for (const viewPart of this._viewParts) {\n            if (viewPart.shouldRender()) {\n                result[resultLen++] = viewPart;\n            }\n        }\n        return result;\n    }\n    _createCoordinatedRendering() {\n        return {\n            prepareRenderText: () => {\n                if (this._shouldRecomputeGlyphMarginLanes) {\n                    this._shouldRecomputeGlyphMarginLanes = false;\n                    const model = this._computeGlyphMarginLanes();\n                    this._context.configuration.setGlyphMarginDecorationLaneCount(model.requiredLanes);\n                }\n                inputLatency.onRenderStart();\n            },\n            renderText: () => {\n                if (!this.domNode.domNode.isConnected) {\n                    return null;\n                }\n                let viewPartsToRender = this._getViewPartsToRender();\n                if (!this._viewLines.shouldRender() && viewPartsToRender.length === 0) {\n                    // Nothing to render\n                    return null;\n                }\n                const partialViewportData = this._context.viewLayout.getLinesViewportData();\n                this._context.viewModel.setViewport(partialViewportData.startLineNumber, partialViewportData.endLineNumber, partialViewportData.centeredLineNumber);\n                const viewportData = new ViewportData(this._selections, partialViewportData, this._context.viewLayout.getWhitespaceViewportData(), this._context.viewModel);\n                if (this._contentWidgets.shouldRender()) {\n                    // Give the content widgets a chance to set their max width before a possible synchronous layout\n                    this._contentWidgets.onBeforeRender(viewportData);\n                }\n                if (this._viewLines.shouldRender()) {\n                    this._viewLines.renderText(viewportData);\n                    this._viewLines.onDidRender();\n                    // Rendering of viewLines might cause scroll events to occur, so collect view parts to render again\n                    viewPartsToRender = this._getViewPartsToRender();\n                }\n                return [viewPartsToRender, new RenderingContext(this._context.viewLayout, viewportData, this._viewLines)];\n            },\n            prepareRender: (viewPartsToRender, ctx) => {\n                for (const viewPart of viewPartsToRender) {\n                    viewPart.prepareRender(ctx);\n                }\n            },\n            render: (viewPartsToRender, ctx) => {\n                for (const viewPart of viewPartsToRender) {\n                    viewPart.render(ctx);\n                    viewPart.onDidRender();\n                }\n            }\n        };\n    }\n    // --- BEGIN CodeEditor helpers\n    delegateVerticalScrollbarPointerDown(browserEvent) {\n        this._scrollbar.delegateVerticalScrollbarPointerDown(browserEvent);\n    }\n    delegateScrollFromMouseWheelEvent(browserEvent) {\n        this._scrollbar.delegateScrollFromMouseWheelEvent(browserEvent);\n    }\n    restoreState(scrollPosition) {\n        this._context.viewModel.viewLayout.setScrollPosition({\n            scrollTop: scrollPosition.scrollTop,\n            scrollLeft: scrollPosition.scrollLeft\n        }, 1 /* ScrollType.Immediate */);\n        this._context.viewModel.visibleLinesStabilized();\n    }\n    getOffsetForColumn(modelLineNumber, modelColumn) {\n        const modelPosition = this._context.viewModel.model.validatePosition({\n            lineNumber: modelLineNumber,\n            column: modelColumn\n        });\n        const viewPosition = this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(modelPosition);\n        this._flushAccumulatedAndRenderNow();\n        const visibleRange = this._viewLines.visibleRangeForPosition(new Position(viewPosition.lineNumber, viewPosition.column));\n        if (!visibleRange) {\n            return -1;\n        }\n        return visibleRange.left;\n    }\n    getTargetAtClientPoint(clientX, clientY) {\n        const mouseTarget = this._pointerHandler.getTargetAtClientPoint(clientX, clientY);\n        if (!mouseTarget) {\n            return null;\n        }\n        return ViewUserInputEvents.convertViewToModelMouseTarget(mouseTarget, this._context.viewModel.coordinatesConverter);\n    }\n    createOverviewRuler(cssClassName) {\n        return new OverviewRuler(this._context, cssClassName);\n    }\n    change(callback) {\n        this._viewZones.changeViewZones(callback);\n        this._scheduleRender();\n    }\n    render(now, everything) {\n        if (everything) {\n            // Force everything to render...\n            this._viewLines.forceShouldRender();\n            for (const viewPart of this._viewParts) {\n                viewPart.forceShouldRender();\n            }\n        }\n        if (now) {\n            this._flushAccumulatedAndRenderNow();\n        }\n        else {\n            this._scheduleRender();\n        }\n    }\n    writeScreenReaderContent(reason) {\n        this._textAreaHandler.writeScreenReaderContent(reason);\n    }\n    focus() {\n        this._textAreaHandler.focusTextArea();\n    }\n    isFocused() {\n        return this._textAreaHandler.isFocused();\n    }\n    setAriaOptions(options) {\n        this._textAreaHandler.setAriaOptions(options);\n    }\n    addContentWidget(widgetData) {\n        this._contentWidgets.addWidget(widgetData.widget);\n        this.layoutContentWidget(widgetData);\n        this._scheduleRender();\n    }\n    layoutContentWidget(widgetData) {\n        var _a, _b, _c, _d, _e, _f, _g, _h;\n        this._contentWidgets.setWidgetPosition(widgetData.widget, (_b = (_a = widgetData.position) === null || _a === void 0 ? void 0 : _a.position) !== null && _b !== void 0 ? _b : null, (_d = (_c = widgetData.position) === null || _c === void 0 ? void 0 : _c.secondaryPosition) !== null && _d !== void 0 ? _d : null, (_f = (_e = widgetData.position) === null || _e === void 0 ? void 0 : _e.preference) !== null && _f !== void 0 ? _f : null, (_h = (_g = widgetData.position) === null || _g === void 0 ? void 0 : _g.positionAffinity) !== null && _h !== void 0 ? _h : null);\n        this._scheduleRender();\n    }\n    removeContentWidget(widgetData) {\n        this._contentWidgets.removeWidget(widgetData.widget);\n        this._scheduleRender();\n    }\n    addOverlayWidget(widgetData) {\n        this._overlayWidgets.addWidget(widgetData.widget);\n        this.layoutOverlayWidget(widgetData);\n        this._scheduleRender();\n    }\n    layoutOverlayWidget(widgetData) {\n        const newPreference = widgetData.position ? widgetData.position.preference : null;\n        const shouldRender = this._overlayWidgets.setWidgetPosition(widgetData.widget, newPreference);\n        if (shouldRender) {\n            this._scheduleRender();\n        }\n    }\n    removeOverlayWidget(widgetData) {\n        this._overlayWidgets.removeWidget(widgetData.widget);\n        this._scheduleRender();\n    }\n    addGlyphMarginWidget(widgetData) {\n        this._glyphMarginWidgets.addWidget(widgetData.widget);\n        this._shouldRecomputeGlyphMarginLanes = true;\n        this._scheduleRender();\n    }\n    layoutGlyphMarginWidget(widgetData) {\n        const newPreference = widgetData.position;\n        const shouldRender = this._glyphMarginWidgets.setWidgetPosition(widgetData.widget, newPreference);\n        if (shouldRender) {\n            this._shouldRecomputeGlyphMarginLanes = true;\n            this._scheduleRender();\n        }\n    }\n    removeGlyphMarginWidget(widgetData) {\n        this._glyphMarginWidgets.removeWidget(widgetData.widget);\n        this._shouldRecomputeGlyphMarginLanes = true;\n        this._scheduleRender();\n    }\n};\nView = __decorate([\n    __param(6, IInstantiationService)\n], View);\nexport { View };\nfunction safeInvokeNoArg(func) {\n    try {\n        return func();\n    }\n    catch (e) {\n        onUnexpectedError(e);\n        return null;\n    }\n}\nclass EditorRenderingCoordinator {\n    constructor() {\n        this._coordinatedRenderings = [];\n        this._animationFrameRunners = new Map();\n    }\n    scheduleCoordinatedRendering(rendering) {\n        this._coordinatedRenderings.push(rendering);\n        this._scheduleRender(rendering.window);\n        return {\n            dispose: () => {\n                const renderingIndex = this._coordinatedRenderings.indexOf(rendering);\n                if (renderingIndex === -1) {\n                    return;\n                }\n                this._coordinatedRenderings.splice(renderingIndex, 1);\n                if (this._coordinatedRenderings.length === 0) {\n                    // There are no more renderings to coordinate => cancel animation frames\n                    for (const [_, disposable] of this._animationFrameRunners) {\n                        disposable.dispose();\n                    }\n                    this._animationFrameRunners.clear();\n                }\n            }\n        };\n    }\n    _scheduleRender(window) {\n        if (!this._animationFrameRunners.has(window)) {\n            const runner = () => {\n                this._animationFrameRunners.delete(window);\n                this._onRenderScheduled();\n            };\n            this._animationFrameRunners.set(window, dom.runAtThisOrScheduleAtNextAnimationFrame(window, runner, 100));\n        }\n    }\n    _onRenderScheduled() {\n        const coordinatedRenderings = this._coordinatedRenderings.slice(0);\n        this._coordinatedRenderings = [];\n        for (const rendering of coordinatedRenderings) {\n            safeInvokeNoArg(() => rendering.prepareRenderText());\n        }\n        const datas = [];\n        for (let i = 0, len = coordinatedRenderings.length; i < len; i++) {\n            const rendering = coordinatedRenderings[i];\n            datas[i] = safeInvokeNoArg(() => rendering.renderText());\n        }\n        for (let i = 0, len = coordinatedRenderings.length; i < len; i++) {\n            const rendering = coordinatedRenderings[i];\n            const data = datas[i];\n            if (!data) {\n                continue;\n            }\n            const [viewParts, ctx] = data;\n            safeInvokeNoArg(() => rendering.prepareRender(viewParts, ctx));\n        }\n        for (let i = 0, len = coordinatedRenderings.length; i < len; i++) {\n            const rendering = coordinatedRenderings[i];\n            const data = datas[i];\n            if (!data) {\n                continue;\n            }\n            const [viewParts, ctx] = data;\n            safeInvokeNoArg(() => rendering.render(viewParts, ctx));\n        }\n    }\n}\nEditorRenderingCoordinator.INSTANCE = new EditorRenderingCoordinator();\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}